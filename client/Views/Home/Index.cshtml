@model IEnumerable<Event>
@{
    ViewData["Title"] = "Home Page";
}
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>

<!-- Täysleveä video -->
<div class="full-width-image-wrapper">
    <video autoplay muted loop playsinline class="full-width-image">
        <source src="~/images/logovideo.mp4" type="video/mp4" />
        Selaimesi ei tue videota.
    </video>
</div>

<!-- Kuvapalkki keskelle -->
<div class="text-center">
    <img src="~/images/lippuotsikko.png" alt="Kuva" style="height: 6rem;" />
</div>

<!-- Tapahtumat -->
<div class="text-center">
    @foreach (var item in Model)
    {
        var eventId = item.EventId;
        var dateString = item.Date?.ToString("o") ?? "";
        var startDate = item.Date?.ToString("dd.MM.yyyy HH:mm") ?? "";

        <h3 class="event-title">
            <a href="/Events/Details/@eventId">@item.Name</a>
        </h3>
        <div class="event-date"><strong>@startDate</strong></div>
        <div id="countdown-@eventId" class="event-countdown"></div>

        <script>
            (function () {
                const countdownId = "countdown-@eventId";
                const endDate = moment("@dateString");

                function updateCountdown() {
                    const now = moment();
                    const diff = moment.duration(endDate.diff(now));

                    if (diff.asSeconds() > 0) {
                        document.getElementById(countdownId).innerHTML =
                            Math.floor(diff.asDays()) + " päivää " +
                            diff.hours() + " tuntia " +
                            diff.minutes() + " minuuttia " +
                            diff.seconds() + " sekuntia";
                    } else {
                        document.getElementById(countdownId).innerHTML = "Tapahtuma on alkanut!";
                    }
                }

                updateCountdown();
                setInterval(updateCountdown, 1000);
            })();
        </script>
    }
</div>